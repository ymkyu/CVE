# CVE-2024-33792

- [netis MEX605](#netis-mex605)
  * [Target](#target)
  * [Bug Type](#bug-type)
  * [Abstract](#abstract)
  * [Reproduce](#reproduce)
  * [Details](#details)
    + [Bug Causes](#bug-causes)
  * [Conclusion](#conclusion)
  * [Discoverer](#discoverer)

## Target

netis MEX605 Router

| Firmware Version | Availability |
| --- | --- |
| 2.00.06 | True |

## Bug Type

Command Injection

## Abstract

Command Injection is possible when the tracert command is executed due to insufficient verification of the input value for the IP or domain name, which is the input value of the tracert test present in the router's advanced -> diagnostic menu.

## Reproduce

```bash
python poc.py
```

## Details

### Bug Causes

`/www/js/diagnosis.js:9`

```bash
        diagnostic_start:function(){
                var me = this;
[1]             var obj = me.setPingData();

                if(obj==false){
                        return false;
                }

                if(obj.command=="ping"){
                        var t1={"jsonrpc": "2.0", "id":20, "method": "call", "params": [ localStorage.getItem('token_id'), "network_tools", "tools_ping", obj ] };
                }else{
 [2]                    var t1={"jsonrpc": "2.0", "id":20, "method": "call", "params": [ localStorage.getItem('token_id'), "network_tools", "tools_traceroute", obj ] };
                }

                t1=JSON.stringify(t1);

                $("#diagnosis_form").attr("command", obj);

                request({
                        url:"/ubus",
[3]                     data:t1
                }).done(function(data){

                        if(data.result!=0){

                                $("#log-cnt").val(base64decode(data.result[1]["result_buf"]));
                        }
                }).fail(function(data){

                        console.log(data)

                })

        },
```

`/www/cgi-bin/network_tools:73`

```
#tracert
function tracert_end()
{
        killall traceroute
        rm -rf /tmp/traceroute.txt
}

function tracert_start()
{
        tracert_end
[4]     traceroute $1 -m $2 > /tmp/traceroute.txt&
}
```

`obj` is not filtered.

it occurs command injection in `tracert`[4].

## Conclusion

Malicious Input can cause Command Injection in `tracert_start` function.

It can be used as malicious way.

## Discoverer

CoreSecurity OT/ICS Research Team
